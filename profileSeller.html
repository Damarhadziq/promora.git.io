<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Penjual - Promora</title>
    <script src="https://cdn.tailwindcss.com"></script>
            <link
      rel="shortcut icon"
      href="./assets/img/logo.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css"/>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#7A5AF8',
                        'primary-dark': '#6344E6',
                    }
                }
            }
        }
    </script>
    <style>
        .profile-image-wrapper {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto;
        }
        
        .profile-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .upload-overlay {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 40px;
            height: 40px;
            background: #7A5AF8;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid white;
        }
        
        .upload-overlay:hover {
            background: #6347d8;
            transform: scale(1.1);
        }
                .badge-gold {
        display: inline-flex;
        align-items: center;
        gap: 1px;
        padding: 2px 6px;
        border-radius: 9999px;

        /* Warna gold */
        background: linear-gradient(135deg, #FFD700, #F2C94C, #E6B800);
        color: #674300; /* teks gold gelap biar kebaca */

        font-weight: 600;
        font-size: 14px;
        box-shadow: 0 6px 6px rgba(255, 200, 0, 0.4);
    }
            .gold-icon {
            width: 20px;   /* bebas atur */
            height: 20px;  /* bebas atur */
            flex-shrink: 0;
        }
        .badge-verified {
            background: linear-gradient(135deg, #34D399, #059669); /* hijau fresh */
            color: white;
            padding: 4px 10px;
            border-radius: 9999px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
        }

        .badge-verified i {
            font-size: 16px;
        }

        .badge-basic {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    border-radius: 9999px;
    background: linear-gradient(135deg, #9CA3AF, #6B7280);
    color: white;
    font-weight: 600;
    font-size: 14px;
    box-shadow: 0 4px 6px rgba(107, 114, 128, 0.3);
}

.badge-bronze {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    border-radius: 9999px;
    background: linear-gradient(135deg, #CD7F32, #A0522D);
    color: white;
    font-weight: 600;
    font-size: 14px;
    box-shadow: 0 4px 6px rgba(205, 127, 50, 0.4);
}

.badge-silver {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    border-radius: 9999px;
    background: linear-gradient(135deg, #E5E7EB, #9CA3AF);
    color: #1F2937;
    font-weight: 600;
    font-size: 14px;
    box-shadow: 0 4px 6px rgba(156, 163, 175, 0.4);
}

.badge-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
}

        .gradient-bg { background: linear-gradient(135deg, #7A5AF8 0%, #A78BFA 100%); }
        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .profile-image { width: 120px; height: 120px; object-fit: cover; border-radius: 50%; border: 5px solid white; }
        .upload-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.5); border-radius: 50%; opacity: 0; transition: opacity 0.3s; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .profile-image-wrapper:hover .upload-overlay { opacity: 1; }
        .stat-card { transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-4px); }
        .notification { position: fixed; top: 20px; right: 20px; background: #10B981; color: white; padding: 16px 24px; border-radius: 12px; display: flex; align-items: center; gap: 12px; z-index: 100; opacity: 0; transform: translateX(100%); transition: all 0.4s; box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3); }
        .notification.show { opacity: 1; transform: translateX(0); }
        .tab-button.active { @apply text-primary border-b-2 border-primary; }

    </style>
</head>
<body class="bg-gray-50">

    <!-- Navbar -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-6 py-4">
        <div class="flex justify-between items-center">
          <a href="index.html" class="flex items-center space-x-2">
            <div class="flex items-center space-x-2">
              <img
                class="h-8 flex items-center justify-center"
                src="./assets/img/Container.png"
                alt=""
              />
            </div>
          </a>
            
             </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle text-xl"></i>
        <span id="notificationText">Profil berhasil diperbarui!</span>
    </div>

    <!-- Main Content -->
    <div class="pt-20 pb-12 min-h-screen">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid lg:grid-cols-3 gap-8">

                <!-- Left Sidebar - Profile Card -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl card-shadow overflow-hidden">
                        <!-- Header gradient -->
                        <div class="gradient-bg h-32"></div>
                        
                        <!-- Profile Image -->
                        <div class="px-6 pb-6 -mt-16">
                            <div class="profile-image-wrapper">
                                <img id="profileImage" src="https://ui-avatars.com/api/?name=Store&size=300&background=7A5AF8&color=fff&bold=true" 
                                     alt="Store Logo" class="profile-image">
                                <label for="imageUpload" class="upload-overlay">
                                    <i class="fas fa-camera text-white"></i>
                                </label>
                                <input type="file" id="imageUpload" class="hidden" accept="image/*" onchange="handleImageUpload(event)">
                            </div>
                            
                            <div class="text-center mt-4">
                                <h2 class="text-2xl font-bold text-gray-800" id="displayName">Nama Toko</h2>
                                <p class="text-primary font-semibold">@sarahjastip</p>
                                <p class="text-gray-500 text-sm mt-1">Jakarta • Bergabung Maret 2024</p>
                                
                                <div class="flex justify-center gap-2 mt-3">
                                    <span class="badge-verified">
                                        <i class="fas fa-check-circle mr-1"></i> Terverifikasi
                                    </span>
                                    <span id="packageBadge" class="badge-basic flex items-center gap-1">
                                        <i class="fas fa-user"></i>
                                        Basic
                                    </span>
                                </div>
                            </div>

                            <!-- Seller Stats -->
                            <div class="grid grid-cols-3 gap-4 mt-8 pt-6 border-t">
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-primary" id="sidebarProductCount">0</div>
                                    <div class="text-xs text-gray-500">Produk Aktif</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-primary" id="sidebarOrderCount">0</div>
                                    <div class="text-xs text-gray-500">Pesanan Selesai</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-primary" id="sidebarRating">0.0</div>
                                    <div class="text-xs text-gray-500">Rating</div>
                                </div>
                            </div>

                            <!-- Earnings Summary -->
                            <div class="bg-gray-50 rounded-xl p-5 mt-6">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-600">Total Pendapatan</span>
                                    <span class="text-2xl font-bold text-primary">Rp 48.2Jt</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-green-600">+Rp 3.8Jt bulan ini</span>
                                    <a href="#" class="text-primary font-medium">Lihat Detail →</a>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="mt-6 space-y-3">
                                <a href="homeSeller.html" class="w-full bg-primary text-white py-3 rounded-lg hover:bg-primary-dark transition font-semibold flex items-center justify-center gap-2">
                                    <i class="fas fa-plus"></i> Tambah Produk Baru
                                </a>
                                <button onclick="switchTab('edit')" class="w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition font-semibold">
                                    <i class="fas fa-edit mr-2"></i> Edit Profil Toko
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Links Seller -->
                    <div class="bg-white rounded-2xl card-shadow p-6 mt-6">
                        <h3 class="font-bold text-gray-800 mb-4">Menu Penjual</h3>
                        <div class="space-y-3">
                            <a href="produk-saya.html" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-box w-5"></i>
                                <span class="ml-3">Produk Saya</span>
                            </a>
                            <a href="pesanan-masuk.html" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-shopping-bag w-5"></i>
                                <span class="ml-3">Pesanan Masuk</span>
                            </a>
                            <a href="withdraw.html" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-wallet w-5"></i>
                                <span class="ml-3">Penarikan Dana</span>
                            </a>
                            <a href="statistik.html" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-chart-bar w-5"></i>
                                <span class="ml-3">Statistik Penjualan</span>
                            </a>
                            <a href="promo-saya.html" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-tag w-5"></i>
                                <span class="ml-3">Promo Saya</span>
                            </a>
                            <a href="#" class="flex items-center text-gray-600 hover:text-primary transition">
                                <i class="fas fa-headset w-5"></i>
                                <span class="ml-3">Bantuan Penjual</span>
                            </a>
                             <a href="lamanLogin.html" onclick="logout(); return false;" class="flex items-center text-red-600 hover:text-primary transition">
                                <i class="fas fa-sign-out-alt text-xl"></i>
                                <span class="ml-3">Logout</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Right Content -->
                <div class="lg:col-span-2">
                    <!-- Breadcrumb -->
                <div class="max-w-5xl mx-auto px-6 py-6">
                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                        </svg>
                        <span>Toko</span>
                        <span>›</span>
                        <a href="homeSeller.html"><span>Produk Saya</span></a>
                        <span>›</span>
                        <span class="text-primary font-medium">Profile</span>
                    </div>
                </div>
                    <div class="bg-white rounded-2xl card-shadow">
                        <div class="border-b px-6">
                            <div class="flex gap-8">
                                <button onclick="switchTab('overview')" class="tab-button active py-4 font-semibold" data-tab="overview">Dashboard</button>
                                <button onclick="switchTab('edit')" class="tab-button py-4 font-semibold text-gray-500" data-tab="edit">Edit Profil Toko</button>
                                <button onclick="switchTab('bank')" class="tab-button py-4 font-semibold text-gray-500" data-tab="bank">Rekening Bank</button>
                                <button onclick="switchTab('activity')" class="tab-button py-4 font-semibold text-gray-500" data-tab="activity">Aktivitas</button>
                            </div>
                        </div>

                        <div class="p-6">
                            <!-- Dashboard Tab -->
                            <div id="overviewTab" class="tab-content">
                                <h3 class="text-2xl font-bold text-gray-800 mb-6">Dashboard Penjual</h3>
                                
                                <div class="grid md:grid-cols-3 gap-6 mb-8">
                                    <div class="stat-card bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-gray-600 text-sm">Pendapatan Bulan Ini</p>
                                                <p class="text-2xl font-bold text-gray-800 mt-1">Rp 3.8Jt</p>
                                            </div>
                                            <i class="fas fa-coins text-3xl text-primary opacity-70"></i>
                                        </div>
                                    </div>
                                    <div class="stat-card bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-gray-600 text-sm">Pesanan Baru</p>
                                                <p class="text-2xl font-bold text-gray-800 mt-1">24</p>
                                            </div>
                                            <i class="fas fa-shopping-cart text-3xl text-green-600 opacity-70"></i>
                                        </div>
                                    </div>
                                    <div class="stat-card bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-gray-600 text-sm">Rating Toko</p>
                                                <p class="text-2xl font-bold text-gray-800 mt-1">4.9 ★</p>
                                            </div>
                                            <i class="fas fa-star text-3xl text-yellow-500 opacity-70"></i>
                                        </div>
                                    </div>
                                </div>

                                <!-- Toko Info -->
                                <div class="bg-gray-50 rounded-xl p-6">
                                    <h4 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <i class="fas fa-store text-primary"></i> Informasi Toko
                                    </h4>
                                    <div class="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <p class="text-sm text-gray-500">Nama Toko</p>
                                            <p class="font-semibold text-gray-800">Sarah Jastip Official</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Kategori Utama</p>
                                            <p class="font-semibold text-gray-800">Fashion • Kecantikan • Gadget</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Lokasi Jastip</p>
                                            <p class="font-semibold text-gray-800">Jakarta, Bandung, Surabaya</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Total Pengikut</p>
                                            <p class="font-semibold text-gray-800">12.4K pemburu promo</p>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <p class="text-sm text-gray-500">Bio Toko</p>
                                        <p class="text-gray-700 leading-relaxed">Bio Masih Kosong.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Edit Profil Toko -->
                            <div id="editTab" class="tab-content hidden">
                                <h3 class="text-2xl font-bold text-gray-800 mb-6">Edit Profil Toko</h3>
                                <form onsubmit="saveSellerProfile(event)" class="space-y-6">
                                    <div class="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Toko</label>
                                            <input type="text" value="Masukkan Nama Toko" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                            <input type="text" value="@sarahjastip" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none">
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Bio Toko</label>
                                        <textarea rows="4" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none">Deskripsi toko anda......</textarea>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Kategori Jastip (pilih maks 3)</label>
                                        <div class="grid grid-cols-3 gap-3">
                                            <label class="flex items-center gap-2"><input type="checkbox" checked> <span>Fashion</span></label>
                                            <label class="flex items-center gap-2"><input type="checkbox" checked> <span>Kecantikan</span></label>
                                            <label class="flex items-center gap-2"><input type="checkbox" checked> <span>Gadget</span></label>
                                            <label class="flex items-center gap-2"><input type="checkbox"> <span>Makanan</span></label>
                                            <label class="flex items-center gap-2"><input type="checkbox"> <span>Mainan</span></label>
                                            <label class="flex items-center gap-2"><input type="checkbox"> <span>Lainnya</span></label>
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Kota Jastip</label>
                                        <input type="text" value="Jakarta, Bandung, Surabaya" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none">
                                    </div>

                                    <div class="flex gap-4">
                                        <button type="submit" class="flex-1 bg-primary text-white py-3 rounded-lg hover:bg-primary-dark transition font-semibold">
                                            Simpan Perubahan
                                        </button>
                                        <button type="button" onclick="switchTab('overview')" class="px-8 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 transition font-semibold">
                                            Batal
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Rekening Bank -->
                            <div id="bankTab" class="tab-content hidden">
                                <h3 class="text-2xl font-bold text-gray-800 mb-6">Rekening Penarikan</h3>
                                <div class="bg-green-50 border border-green-200 rounded-xl p-6 mb-6">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center text-white text-xl font-bold">BCA</div>
                                            <div>
                                                <p class="font-bold text-gray-800">Bank Central Asia (BCA)</p>
                                                <p class="text-gray-600">a.n. Sarah Amanda • 1234567890</p>
                                            </div>
                                        </div>
                                        <span class="text-green-700 font-medium">Utama</span>
                                    </div>
                                </div>
                                <button class="text-primary font-medium hover:underline">+ Tambah Rekening Baru</button>
                            </div>

                            <!-- Aktivitas -->
                            <div id="activityTab" class="tab-content hidden">
                                <h3 class="text-2xl font-bold text-gray-800 mb-6">Aktivitas Terbaru</h3>
                                <div class="space-y-4">
                                    <div class="flex gap-4 p-4 bg-gray-50 rounded-xl">
                                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"><i class="fas fa-check text-green-600"></i></div>
                                        <div><p class="font-semibold">Pesanan #JST-2025-089 selesai</p><p class="text-sm text-gray-500">2 menit lalu</p></div>
                                    </div>
                                    <div class="flex gap-4 p-4 bg-gray-50 rounded-xl">
                                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"><i class="fas fa-box text-blue-600"></i></div>
                                        <div><p class="font-semibold">Produk baru ditambahkan</p><p class="text-sm text-gray-500">Zara Mini Bag - Rp 480.000 • 15 Kuota</p></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer (sama seperti sebelumnya) -->
    <footer class="bg-primary text-white py-12 mt-20">
        <!-- ... footer kamu yang lama ... -->
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-purple-200">© 2025 Promora — All rights reserved</p>
        </div>
    </footer>

    <script>
let currentUser = null;
let currentStore = null;

// Load user and store data
async function loadProfileData() {
    try {
        // Load user profile
        const userResponse = await fetch('backend/api/get_profile.php', {
            credentials: 'include'
        });
        const userData = await userResponse.json();
        
        if (userData.logged_in && userData.user) {
            currentUser = userData.user;
            
            // Update username display
            document.querySelector('.text-primary.font-semibold').textContent = '@' + userData.user.username;
            
        } else {
            alert('Anda harus login terlebih dahulu');
            window.location.href = 'lamanLogin.html';
            return;
        }
        
        // Load store profile
        const storeResponse = await fetch('backend/api/get_store_profile.php', {
            credentials: 'include'
        });
        const storeData = await storeResponse.json();
        
        if (storeData.success) {
            currentStore = storeData.store;
            updateStoreDisplay(currentStore);
        }
        
    } catch (error) {
        console.error('Error loading profile:', error);
        alert('Gagal memuat profil. Silakan login kembali.');
        window.location.href = 'lamanLogin.html';
    }
}

// Update store display
function updateStoreDisplay(store) {
    // Update nama toko di header
    const displayName = document.getElementById('displayName');
    if (displayName) {
        displayName.textContent = store.store_name;
    }
    
    // Update logo
    if (store.logo) {
        const profileImg = document.getElementById('profileImage');
        if (profileImg) {
            profileImg.src = 'backend/uploads/store_logos/' + store.logo;
        }
    }
    
    // Update package badge - GUNAKAN 'basic' JIKA KOSONG
    const packageTier = store.package_tier || 'basic';
    updatePackageBadge(packageTier);

    // Update di dashboard tab
    const dashboardStoreName = document.querySelector('#overviewTab .font-semibold.text-gray-800');
    if (dashboardStoreName) {
        dashboardStoreName.textContent = store.store_name;
    }
    
    // Update bio toko di dashboard
    const bioDashboard = document.getElementById('dashboardBio');
    if (bioDashboard) {
        bioDashboard.textContent = store.description || 'Bio masih kosong';
    }
    
    // Update form edit profil
    const editInputs = document.querySelectorAll('#editTab input[type="text"]');
    if (editInputs.length >= 2) {
        editInputs[0].value = store.store_name || '';
        editInputs[0].placeholder = 'Masukkan nama toko';
        editInputs[1].value = '@' + currentUser.username;
    }

    const editTextarea = document.querySelector('#editTab textarea');
    if (editTextarea) {
        editTextarea.value = store.description || '';
        editTextarea.placeholder = 'Tulis deskripsi toko Anda...';
    }
    
    // Update stats
    updateStats(store);
}

// Update package badge display
function updatePackageBadge(tier) {
    const badge = document.getElementById('packageBadge');
    if (!badge) return;
    
    // Pastikan tier tidak kosong, default ke 'basic'
    if (!tier || tier === '') {
        tier = 'basic';
    }
    
    const tierData = {
        'basic': {
            class: 'badge-basic',
            icon: '<i class="fas fa-user badge-icon"></i>',
            text: 'Basic'
        },
        'bronze': {
            class: 'badge-bronze',
            icon: '<i class="fas fa-medal badge-icon"></i>',
            text: 'Bronze Seller'
        },
        'silver': {
            class: 'badge-silver',
            icon: '<i class="fas fa-award badge-icon"></i>',
            text: 'Silver Seller'
        },
        'gold': {
            class: 'badge-gold',
            icon: '<i class="fas fa-crown badge-icon" style="color: #FFD700;"></i>',
            text: 'Gold Seller'
        }
    };
    
    // Ambil data tier, kalau tidak ada gunakan basic
    const data = tierData[tier.toLowerCase()] || tierData['basic'];
    
    // Update class dan content
    badge.className = data.class + ' flex items-center gap-1';
    badge.innerHTML = data.icon + ' ' + data.text;
}

// Update statistics
function updateStats(store) {
    const statCards = document.querySelectorAll('.stat-card .text-2xl.font-bold');
    if (statCards.length >= 3) {
        statCards[0].textContent = 'Rp 3.8Jt'; // Dummy
        statCards[1].textContent = '24'; // Dummy
        statCards[2].textContent = '0.0 ★'; // Rating = 0
    }
    
    // Sidebar stats - DINAMIS dari database
    const sidebarProductCount = document.getElementById('sidebarProductCount');
    const sidebarOrderCount = document.getElementById('sidebarOrderCount');
    const sidebarRating = document.getElementById('sidebarRating');
    
    if (sidebarProductCount) sidebarProductCount.textContent = store.total_products || '0';
    if (sidebarOrderCount) sidebarOrderCount.textContent = store.total_orders || '0';
    if (sidebarRating) sidebarRating.textContent = '0.0'; // Rating selalu 0
}

// Save seller profile
async function saveSellerProfile(e) {
    e.preventDefault();
    
    const editInputs = document.querySelectorAll('#editTab input[type="text"]');
    const editTextarea = document.querySelector('#editTab textarea');
    
    const storeName = editInputs[0].value.trim();
    const description = editTextarea.value.trim();
    
    if (!storeName) {
        alert('Nama toko tidak boleh kosong!');
        return;
    }
    
    try {
        const response = await fetch('backend/api/update_store.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({
                store_name: storeName,
                description: description
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            document.getElementById('notificationText').textContent = "Profil toko berhasil diperbarui!";
            document.getElementById('notification').classList.add('show');
            setTimeout(() => {
                document.getElementById('notification').classList.remove('show');
                loadProfileData(); // Reload data
                switchTab('overview'); // Kembali ke dashboard
            }, 2000);
        } else {
            alert('Gagal menyimpan: ' + (data.message || 'Unknown error'));
        }
    } catch (error) {
        console.error('Error saving profile:', error);
        alert('Terjadi kesalahan saat menyimpan');
    }
}

// Logout function
async function logout() {
    if (!confirm('Apakah Anda yakin ingin logout?')) {
        return;
    }
    
    try {
        const response = await fetch('backend/api/logout.php', {
            method: 'POST',
            credentials: 'include'
        });
        
        const data = await response.json();
        
        if (response.ok) {
            alert('Logout berhasil!');
            window.location.href = 'lamanLogin.html';
        } else {
            alert('Gagal logout');
        }
    } catch (error) {
        console.error('Logout error:', error);
        // Tetap redirect meskipun error
        window.location.href = 'lamanLogin.html';
    }
}

// Switch tab function
function switchTab(tab) {
    document.querySelectorAll('.tab-button').forEach(b => {
        b.classList.remove('active', 'text-primary', 'border-b-2', 'border-primary');
        b.classList.add('text-gray-500');
    });
    
    const activeButton = document.querySelector('.tab-button[data-tab="' + tab + '"]');
    if (activeButton) {
        activeButton.classList.add('active', 'text-primary', 'border-b-2', 'border-primary');
        activeButton.classList.remove('text-gray-500');
    }
    
    document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
    
    const activeTab = document.getElementById(tab + 'Tab');
    if (activeTab) {
        activeTab.classList.remove('hidden');
    }
}

// Handle image upload
function handleImageUpload(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(ev) {
            document.getElementById('profileImage').src = ev.target.result;
        }
        reader.readAsDataURL(file);
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    loadProfileData();
});
    </script>
</body>
</html>